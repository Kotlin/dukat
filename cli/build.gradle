plugins {
  id("kotlin")
  id("kotlinx-serialization")
}

configurations {
  cliRuntime
}


dependencies {
  implementation "org.jetbrains.kotlinx:kotlinx-serialization-runtime:${gradle.kotlinSerializationRuntimeVersion}"

  implementation(project(":ast-declarations"))
  implementation(project(":ast-common"))
  implementation(project(":ast-model"))
  implementation(project(":idl-reference-resolver"))
  implementation(project(":module-name-resolver"))
  implementation(project(":tsmodel"))
  implementation(project(":translator"))
  implementation(project(":translator-string"))
  implementation(project(":compiler"))
  implementation(project(":panic"))


  cliRuntime(project(":compiler"))
}

jar {
  archiveName = "dukat-cli.jar"
  manifest {
    attributes 'Main-Class': 'org.jetbrains.dukat.cli.CliKt'
  }


  from {
    configurations.cliRuntime.collect { it.isDirectory() ? it : zipTree(it) }
  }

}